# Babi E-book Portal

![Project Infographic](app/public/project-overview.png)

Babi E-book Portal คือระบบจัดการห้องสมุดแบบพกพาที่สร้างด้วย Next.js ช่วยให้ผู้ใช้สามารถจัดการและดูคอลเลกชันหนังสือดิจิทัล (PDF และ EPUB) ผ่านอินเทอร์เฟซที่สะอาดและรองรับทุกอุปกรณ์
## ภาพรวมโปรเจกต์

- **วัตถุประสงค์หลัก**: เพื่อเก็บรวบรวมข้อมูลหนังสือและระบบบริหารจัดการทั้งหมดไว้บน Removable Storage (เช่น USB Drive) ทำให้สามารถเคลื่อนย้ายและนำไปใช้งานที่เครื่องอื่นได้อย่างสะดวก
- **เฟรมเวิร์ก**: Next.js 13.4.12 (App Router)
- **ภาษา**: TypeScript
- **ไลบรารี UI**: React 18.2.0
- **ฐานข้อมูล**: SQLite (ผ่าน `better-sqlite3`)
- **การตกแต่ง**: TailwindCSS
- **การจัดเก็บข้อมูล**: ใช้ระบบไฟล์ในเครื่องสำหรับเก็บไฟล์หนังสือ

## ฟีเจอร์

- **แสดงรายชื่อหนังสือ**: 
- [] เลือกดูหนังสือ
- [x] ระบบแบ่งหน้า
- **ข้อมูลหนังสือ**: 
- [x] รายละเอียดหนังสือ
- [] รายละเอียดผู้แต่ง
- [] รายละเอียดหมวดหมู่
- [] รายละเอียด ISBN
- [] รายละเอียด ภาษาของหนังสือ
- [] รายละเอียด Edition หนังสือ
- **ค้นหา**: 
- [] ค้นหาแบบเรียลไทม์จากชื่อเรื่อง, ผู้แต่ง, หมวดหมู่ หรือ ISBN
- **นำเข้าหนังสือ**: 
- [x] อัปโหลดไฟล์ PDF และ EPUB ได้โดยตรงผ่านแอปพลิเคชัน
- [x] Ask Google เรียกข้อมูลหนังสือจาก Google Books API
- [x] ป้องกันการอัพโหลดไฟล์หนังสือซ้ำได้
- [] ข้อมูลรายละเอียดหนังสือที่อยู่ใน meta data ไฟล์ PDF จะต้องตรงกับในฐานข้อมูลระบบ 
- **พกพาได้**: ออกแบบมาให้รันได้ด้วย Node.js runtime ในเครื่อง หรือ system runtime

## การเริ่มต้นใช้งาน

### สิ่งที่ต้องมี

- Node.js 18+ (แนะนำ)

### การติดตั้ง

1.  **Clone repository** (ถ้ามี) หรือเข้าไปที่โฟลเดอร์โปรเจกต์:
    ```bash
    cd app
    ```

2.  **ติดตั้ง dependencies**:
    ```bash
    npm install
    ```

### การรันแอปพลิเคชัน

สำหรับเริ่ม development server:

```bash
npm run dev
```

เปิด [http://localhost:3000](http://localhost:3000) ในเบราว์เซอร์เพื่อดูผลลัพธ์

## โครงสร้างโปรเจกต์

```
/workspaces/iconnext.babi/
├── app/                  # แอปพลิเคชัน Next.js หลัก
│   ├── src/
│   │   ├── app/          # หน้าเว็บ App router และ API routes
│   │   ├── components/   # React components
│   │   └── lib/          # Utilities (เช่น การเชื่อมต่อฐานข้อมูล)
│   ├── public/           # ไฟล์ Static assets
│   └── ...config files
├── data/                 # ไฟล์หนังสือที่ถูกจัดเก็บ (อยู่นอก app/ เพื่อให้คงอยู่แม้จะ build ใหม่)
├── start.sh              # สคริปต์สำหรับเริ่มทำงานบน Linux
└── ...
```

## การแก้ไขฟีเจอร์

นี่คือคำแนะนำสำหรับการแก้ไขส่วนสำคัญของระบบ:

### 1. การแก้ไขระบบนำเข้าหนังสือ (Import Logic)
ส่วนนี้จัดการการอัปโหลดไฟล์ การตรวจสอบ และการบันทึกลงฐานข้อมูล
- **ไฟล์**: `app/src/app/api/books/import/route.ts`
- **ลอจิกสำคัญ**:
    - ตรวจสอบไฟล์ (รองรับ .pdf, .epub).
    - บันทึกไฟล์ (เขียนลงใน `../data/books/...`).
    - บันทึกฐานข้อมูล (อัปเดตตาราง `books`, `authors`, `book_authors`).

### 2. การปรับแต่ง UI
หน้าหลักจะแสดงรายชื่อหนังสือและแถบค้นหา
- **หน้าหลัก**: `app/src/app/page.tsx` (Server Component, จัดการการดึงข้อมูล).
- **ส่วน Client**: `app/src/app/ClientHome.tsx` (Client Component, จัดการการโต้ตอบ).
- **สไตล์**: `app/src/app/globals.css` และคลาส Tailwind

### 3. โครงสร้างฐานข้อมูล (Database Schema)
โปรเจกต์ใช้ SQLite หากต้องการแก้ไขโครงสร้าง:
- ดูไฟล์ `app/check_db.js` หรือ `app/seed_dummy.js` เพื่อดูวิธีการสร้างตาราง
- หากมีการเปลี่ยน Schema อย่าลืมอัปเดต type ใน `app/src/lib/types.ts` (ถ้ามี) และคำสั่ง query ใน `app/src/app/page.tsx`

## การนำขึ้นใช้งาน (Deployment)

เมื่อต้องการ build เพื่อใช้งานจริง:

```bash
npm run build
npm start
```

## การติดตั้งและอัปเดตบน Removable Storage (USB/External Drive)

ส่วนนี้สำหรับผู้ดูแลระบบที่ต้องการติดตั้ง Babi E-book Portal ลงในอุปกรณ์พกพาเพื่อให้สามารถนำไปใช้งานได้ทันที

### 1. การติดตั้งครั้งแรก (First-time Installation)

สำหรับอุปกรณ์ที่ยังไม่เคยติดตั้งระบบมาก่อน:

1.  **เตรียม Source Code (เครื่อง Developer)**
    - เปิด Terminal และเข้าไปที่โฟลเดอร์ `app`
    - รันคำสั่งติดตั้ง dependencies และ build โปรเจกต์:
      ```bash
      npm install
      npm run build
      ```

2.  **เตรียมพื้นที่จัดเก็บ (Removable Storage)**
    - สร้างโฟลเดอร์หลักบนอุปกรณ์ USB ของคุณ เช่น `BabiLibrary`

3.  **คัดลอกไฟล์ไปยังอุปกรณ์**
    คัดลอกไฟล์และโฟลเดอร์จากเครื่อง Developer ไปยังโฟลเดอร์ `BabiLibrary` บน USB ดังนี้:
    
    *ในโฟลเดอร์ `app/`:*
    - `.next` (โฟลเดอร์ที่ได้จากการ build)
    - `node_modules` (ไลบรารีต่างๆ)
    - `public` (ไฟล์รูปภาพและ assets)
    - `package.json`
    - `next.config.js`
    
    *นอกโฟลเดอร์ `app/`:*
    - `data` (สร้างโฟลเดอร์เปล่าไว้สำหรับเก็บหนังสือ)

    **โครงสร้างไฟล์บน USB ควรเป็นดังนี้:**
    ```
    BabiLibrary/
    ├── app/
    │   ├── .next/
    │   ├── node_modules/
    │   ├── public/
    │   ├── package.json
    │   └── next.config.js
    └── data/
    ```

    > **หมายเหตุสำคัญ (Cross-Platform)**: เนื่องจากโปรเจกต์ใช้ `better-sqlite3` ซึ่งเป็น Native Module หากคุณ Build บนเครื่อง Linux แต่จะนำไปรันบน Windows (หรือกลับกัน) คุณอาจจำเป็นต้องรัน `npm rebuild better-sqlite3` หรือ `npm install` อีกครั้งบนเครื่องปลายทางเพื่อให้ทำงานได้ถูกต้อง

4.  **การใช้งาน**
    - เสียบ USB เข้ากับคอมพิวเตอร์
    - เปิด Terminal/Command Prompt เข้าไปที่ `BabiLibrary/app` บน USB
    - รันคำสั่ง `npm start`

---

### 2. การอัปเดตตัวจัดการ (Updating the Manager)

สำหรับกรณีที่มีการแก้ไขบั๊กหรือเพิ่มฟีเจอร์ใหม่ และต้องการอัปเดตลงใน USB เดิม (โดยไม่กระทบข้อมูลหนังสือ):

1.  **Build เวอร์ชันใหม่ (เครื่อง Developer)**
    - ทำการแก้ไขและทดสอบ Code ให้เรียบร้อย
    - รันคำสั่ง build ใหม่:
      ```bash
      cd app
      npm run build
      ```

2.  **อัปเดตไฟล์บนอุปกรณ์ (Removable Storage)**
    นำ USB มาเสียบที่เครื่อง Developer และดำเนินการดังนี้:
    
    1. เข้าไปที่โฟลเดอร์ `app` บน USB
    2. **ลบ** โฟลเดอร์ `.next` ของเดิมทิ้ง
    3. **คัดลอก** โฟลเดอร์ `.next` ที่เพิ่ง build ใหม่จากเครื่อง Developer ไปวางแทนที่บน USB
    4. (หากมีการแก้หน้าตาเว็บ/รูปภาพ) ให้คัดลอกโฟลเดอร์ `public` ไปทับของเดิม
    5. (หากมีการเพิ่มไลบรารีใหม่) ให้คัดลอก `package.json` ไปทับ และอาจต้อง copy `node_modules` ใหม่ไปด้วย

    > **คำเตือน**: ห้ามลบโฟลเดอร์ `data/` บน USB เด็ดขาด! เพราะเป็นที่เก็บไฟล์หนังสือทั้งหมด
